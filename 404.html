<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>blopa.dev</title>
  <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon">
  </head>
  <body>
  <div id="main"></div>
  <script src="//cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.min.js" type="text/javascript"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.5/xlsx.full.min.js" type="text/javascript"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.5/jszip.js" type="text/javascript"></script>
  <script type="text/javascript">
  	new Vue({
  		el: '#main',
  		created: function() {
  			this.getSpreadsheetData('1EclVdCu9ioEUBIEbmKD4yJH4rlFCrTqzVypE748P34k', 0);
  		},
  		methods: {
  			getSpreadsheetData: function(spreadsheetId, sheetId = 0) {
				var url = 'https://docs.google.com/spreadsheets/d/' + spreadsheetId + '/export?format=xlsx&gid=' + sheetId;
				var xhr = new XMLHttpRequest();
				xhr.open('GET', url, true);
				xhr.overrideMimeType('text/plain; charset=x-user-defined');
				xhr.onload = (e) => this.onSpreadsheetLoad(e, this);
				xhr.onerror = (e) => {
					alert('Error loading URL.');
				};
				xhr.send(null);
			},
			onSpreadsheetLoad: function(e, $this) {
				var data = e.target.responseText;
				$this.parseSpreadsheetData(data);
			},
			parseSpreadsheetData: function(data) {
				var workbook = XLSX.read(data, {type: 'binary'});
				var sheetName = workbook.SheetNames[0];
				var jsonObject = workbook.Sheets[sheetName];
				jsonObject = XLSX.utils.sheet_to_row_object_array(jsonObject);
				for (const obj of jsonObject) {
					const pathName = window.location.pathname;
					if (`/${jsonObject['Original']}` === pathName) {
						window.location.replace(jsonObject['Original']);
					}
				}

				window.location.replace('https://pablomontenegro.com.br/');
			},
  		},
  	});
  </script>
  </body>
</html>