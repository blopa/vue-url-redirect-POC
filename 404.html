<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>blopa.dev</title>
  <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon">
  </head>
  <body>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.min.js" type="text/javascript"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.5/xlsx.full.min.js" type="text/javascript"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.5/jszip.js" type="text/javascript"></script>
  <script type="text/javascript">
  	new Vue({
  		created: () => {
  			this.getSpreadsheetData('1EclVdCu9ioEUBIEbmKD4yJH4rlFCrTqzVypE748P34k', 0);
  		},
  		methods: {
  			getSpreadsheetData: (spreadsheetId, sheetId = 0) => {
				var url = 'https://docs.google.com/spreadsheets/d/' + spreadsheetId + '/export?format=xlsx&gid=' + sheetId;
				var xhr = new XMLHttpRequest();
				xhr.open('GET', url, true);
				xhr.overrideMimeType('text/plain; charset=x-user-defined');
				xhr.onload = this.onSpreadsheetLoad;
				xhr.onerror = (e) => {
					alert('Error loading URL.');
				};
				xhr.send(null);
			},
			onSpreadsheetLoad: (e) => {
				var data = xhr.responseText;
				var f = new File([], 'sample.xlsx', {type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'});
				var reader = new FileReader();
				reader.onload = (e) => {
					this.parseSpreadsheetData(e, data);
				};
				reader.readAsBinaryString(f);
			},
			parseSpreadsheetData: (event, data) => {
				var workbook = XLSX.read(data, {type: 'binary'});
				var sheetName = workbook.SheetNames[0];
				var jsonObject = workbook.Sheets[sheetName];
				jsonObject = XLSX.utils.sheet_to_row_object_array(jsonObject);
				console.log(jsonObject);
			},
  		},
  	});
  </script>
  </body>
</html>